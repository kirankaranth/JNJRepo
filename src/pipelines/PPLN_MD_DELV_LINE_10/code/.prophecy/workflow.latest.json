{
      "metainfo" : {
        "id" : "1",
        "language" : "python",
        "fabricId" : "32",
        "frontEndLanguage" : "sql",
        "mode" : "batch",
        "udfs" : {
          "language" : "python",
          "udfs" : [ ]
        },
        "udafs" : {
          "language" : "python",
          "code" : ""
        },
        "configuration" : {
          "common" : {
            "type" : "record",
            "fields" : [ {
              "name" : "targetSchema",
              "kind" : {
                "type" : "string",
                "value" : "l1_md_prophecy"
              },
              "optional" : false
            }, {
              "name" : "sourceSystem",
              "kind" : {
                "type" : "string",
                "value" : "jet"
              },
              "optional" : false
            }, {
              "name" : "sourceDatabase",
              "kind" : {
                "type" : "string",
                "value" : "jet"
              },
              "optional" : false
            } ]
          },
          "oldCommon" : {
            "type" : "record",
            "fields" : [ ]
          },
          "fabrics" : { },
          "instances" : { },
          "selected" : "default",
          "nonEditable" : [ ],
          "isSubscribedPipelineWithPipelineConfigs" : false
        },
        "sparkConf" : [ ],
        "hadoopConf" : [ ],
        "codeMode" : "sparse",
        "buildSystem" : "maven",
        "externalDependencies" : [ ],
        "isImported" : false,
        "interimMode" : "Full",
        "interimModeEnabled" : true,
        "visualCodeInterimMode" : "Disabled",
        "recordsLimit" : {
          "enabled" : false,
          "value" : 1000
        },
        "topLevelPackage" : "PPLN_MD_DELV_LINE_10"
      },
      "connections" : [ {
        "id" : "80c292d3-b840-4812-9ccf-602c0ae717f5",
        "source" : "25667bd0-8e7a-4a72-a851-04db6fff0419",
        "sourcePort" : "e0c9b571-a397-4079-801b-7790322b5154",
        "target" : "507fbc0b-271b-4860-b135-9ffd59a882ff",
        "targetPort" : "fc2cc1ee-e60a-4113-8026-88427aa57fad"
      }, {
        "id" : "bba4eb6d-7b65-4c37-8d15-a51e08a374b8",
        "source" : "96b9adb8-254a-475c-9528-74ca307a824b",
        "sourcePort" : "805d1691-1bdf-4736-96d3-0be497b1a57b",
        "target" : "25667bd0-8e7a-4a72-a851-04db6fff0419",
        "targetPort" : "c86bf33c-61be-46b8-b4da-cce0b2317c1e"
      } ],
      "processes" : {
        "507fbc0b-271b-4860-b135-9ffd59a882ff" : {
          "id" : "507fbc0b-271b-4860-b135-9ffd59a882ff",
          "component" : "Target",
          "metadata" : {
            "label" : "MD_DELV_LINE",
            "slug" : "MD_DELV_LINE",
            "x" : -540,
            "y" : -400,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "fc2cc1ee-e60a-4113-8026-88427aa57fad",
              "slug" : "in0",
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false
          },
          "properties" : {
            "datasetId" : "datasets/MD_DELV_LINE"
          }
        },
        "25667bd0-8e7a-4a72-a851-04db6fff0419" : {
          "id" : "25667bd0-8e7a-4a72-a851-04db6fff0419",
          "component" : "SchemaTransform",
          "metadata" : {
            "label" : "addL1fields",
            "slug" : "addL1fields",
            "x" : -780,
            "y" : -400,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "c86bf33c-61be-46b8-b4da-cce0b2317c1e",
              "slug" : "in0",
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "e0c9b571-a397-4079-801b-7790322b5154",
              "slug" : "out",
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "transformations" : [ {
              "kind" : "AddReplaceColumn",
              "AddReplaceColumn" : {
                "sourceColumn" : "SRC_SYS_CD",
                "expression" : {
                  "format" : "sql",
                  "expression" : "'$sourceSystem'"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              }
            }, {
              "kind" : "AddReplaceColumn",
              "AddReplaceColumn" : {
                "sourceColumn" : "_pk_",
                "expression" : {
                  "format" : "sql",
                  "expression" : "to_json(named_struct('SRC_SYS_CD',SRC_SYS_CD,'DELV_NUM',DELV_NUM,'DELV_LINE_NBR',DELV_LINE_NBR,'DELV_TYP_CD',DELV_TYP_CD,'CO_CD',CO_CD,'DOC_REF_NUM',DOC_REF_NUM,'ORDR_SFX',ORDR_SFX,'MATCH_TYPE',MATCH_TYPE,'SRC_TBL_NM',SRC_TBL_NM))"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              }
            }, {
              "kind" : "AddReplaceColumn",
              "AddReplaceColumn" : {
                "sourceColumn" : "_pk_md5_",
                "expression" : {
                  "format" : "sql",
                  "expression" : "md5(to_json(named_struct('SRC_SYS_CD',SRC_SYS_CD,'DELV_NUM',DELV_NUM,'DELV_LINE_NBR',DELV_LINE_NBR,'DELV_TYP_CD',DELV_TYP_CD,'CO_CD',CO_CD,'DOC_REF_NUM',DOC_REF_NUM,'ORDR_SFX',ORDR_SFX,'MATCH_TYPE',MATCH_TYPE,'SRC_TBL_NM',SRC_TBL_NM)))"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              }
            }, {
              "kind" : "AddReplaceColumn",
              "AddReplaceColumn" : {
                "sourceColumn" : "_l1_upt_",
                "expression" : {
                  "format" : "sql",
                  "expression" : "current_timestamp()"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              }
            } ]
          }
        },
        "96b9adb8-254a-475c-9528-74ca307a824b" : {
          "id" : "96b9adb8-254a-475c-9528-74ca307a824b",
          "component" : "Script",
          "metadata" : {
            "label" : "sql_MD_DELV_LINE",
            "slug" : "sql_MD_DELV_LINE",
            "x" : -1060,
            "y" : -400,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "805d1691-1bdf-4736-96d3-0be497b1a57b",
              "slug" : "out0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "_deleted_",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  } 
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true
          },
          "properties" : {
            "script" : "out0 = spark.sql(f\"\"\"\n    with mysub as (\n  SELECT\n    'F4211' AS SRC_TBL_NM,\n    F4211.SDDOC AS DELV_NUM,\n    F4211.SDLNID AS DELV_LINE_NBR,\n    F4211.SDDCTO AS DELV_TYP_CD,\n    F4211.SDKCOO AS CO_CD,\n    NULL AS MATL_SHRT_DESC,\n    NULL AS MATL_MVMT_TYPE_CD,\n    F4211.SDDOCO AS DOC_REF_NUM,\n    NULL AS PICK_CNTL_STS_CD,\n    NULL AS LINE_ITEM_CAT_CD,\n    NULL AS SPL_STK_TYPE_CD,\n    NULL AS PARNT_BTCH_SPLT_CNTR_NBR,\n    NULL AS PARNT_BOM_CNTR_NBR,\n    NULL AS FCTR_NMRTR_MEAS,\n    NULL AS FCTR_DNMNTR_MEAS,\n    NULL AS ACTL_GI_DTTM,\n    CAST (TRIM (F4211.SDSOQS) AS DECIMAL(18, 4)) AS ACTL_SLS_UNIT_DELV_QTY,\n    NULL AS ACTL_SKU_DELV_QTY,\n    NULL AS BASE_UOM_CD,\n    TRIM (F4211.SDLOTN) AS BTCH_NUM,\n    NULL AS BILL_ICMPT_STS_CD,\n    NULL AS CNFRM_STS_CD,\n    NULL AS MFG_DTTM,\n    NULL AS DELV_BILL_STS_CD,\n    NULL AS DELV_CMPLT_IND,\n    NULL AS DELV_ICMPT_STS_CD,\n    NULL AS DELV_STS_CD,\n    NULL AS DELV_TOT_STS_CD,\n    NULL AS EXP_DTTM,\n    NULL AS GM_ICMPT_STS_CD,\n    NULL AS GM_STS_CD,\n    NULL AS INTCO_BILL_STS_CD,\n    TRIM (F4211.SDLITM) AS MATL_NUM,\n    NULL AS ICMPT_STS_CD,\n    NULL AS NUM_OF_CNTNRS_CNT,\n    NULL AS ORDR_BILL_STS_CD,\n    NULL AS PACK_ICMPT_STS_CD,\n    NULL AS PACK_STS_CD,\n    NULL AS PICK_CNFRM_STS_CD,\n    NULL AS PICK_ICMPT_STS_CD,\n    NULL AS PICK_STS_CD,\n    NULL AS PRC_ICMPT_STS_CD,\n    NULL AS PRCSG_TOT_STS_CD,\n    NULL AS RECV_PLNT_CD,\n    NULL AS REF_STS_CD,\n    NULL AS REF_TOT_STS_CD,\n    NULL AS REJ_STS_CD,\n    TRIM (F4211.SDLNID) AS SLS_ORDR_LINE_NBR_REF,\n    NULL AS SLS_ORDR_TYPE_CD,\n    TRIM (F4211.SDUOM) AS SLS_UOM_CD,\n    TRIM (F4211.SDMCU) AS SHIPPING_PLNT_CD,\n    TRIM (F4211.SDLOCN) AS SLOC_CD,\n    NULL AS VEND_BTCH_NUM,\n    NULL AS WM_STS_CD,\n    NULL AS CRT_DTTM,\n    NULL AS ITM_TYPE,\n    NULL AS ITM_OF_REF_DOC,\n    NULL AS GRS_WT_MEAS,\n    NULL AS NET_WT_MEAS,\n    NULL AS WT_UOM_CD,\n    NULL AS VOL_MEAS,\n    NULL AS VOL_UOM_CD,\n    NULL AS NET_VAL_AMT,\n    NULL AS PROD_HIER_CD,\n    NULL AS MATL_GRP_4,\n    NULL AS MATL_GRP_4_DESC,\n    NULL AS DSTR_CHNL_CD,\n    NULL AS ITM_BILL_BLK_STS_CD,\n    NULL AS ITM_OVRL_DELV_BLK_STS_CD,\n    NULL AS ENT_MATL_NUM,\n    NULL AS DIVISION_CD,\n    NULL AS DOC_CAT_SD,\n    NULL AS MATL_GRP_CD,\n    NULL AS MATL_TYPE_CD,\n    NULL AS CUM_BTCH_QTY,\n    F4211.SDSFXO AS ORDR_SFX,\n    null AS MATCH_TYPE,\n    TRIM (F4211.SDLNTY) AS LINE_TYPE_DELV,\n NULL AS ORIG_QTY_DELV_ITM\n  from\n    {Config.sourceDatabase}.F4211 F4211\n  where\n    F4211._deleted_ = 'F'\n  UNION ALL\n  SELECT\n    'F43121' AS SRC_TBL_NM,\n    F43121.PRDOC AS DELV_NUM,\n    CONCAT(F43121.PRLNID, F43121.PRNLIN) AS DELV_LINE_NBR,\n    F43121.PRDCTO AS DELV_TYP_CD,\n    F43121.PRKCOO AS CO_CD,\n    NULL AS MATL_SHRT_DESC,\n    NULL AS MATL_MVMT_TYPE_CD,\n    F43121.PRDOCO AS DOC_REF_NUM,\n    NULL AS PICK_CNTL_STS_CD,\n    NULL AS LINE_ITEM_CAT_CD,\n    NULL AS SPL_STK_TYPE_CD,\n    NULL AS PARNT_BTCH_SPLT_CNTR_NBR,\n    NULL AS PARNT_BOM_CNTR_NBR,\n    NULL AS FCTR_NMRTR_MEAS,\n    NULL AS FCTR_DNMNTR_MEAS,\n    NULL AS ACTL_GI_DTTM,\n    CAST (TRIM (F43121.PRUREC) AS DECIMAL(18, 4)) AS ACTL_SLS_UNIT_DELV_QTY,\n    NULL AS ACTL_SKU_DELV_QTY,\n    NULL AS BASE_UOM_CD,\n    TRIM (F43121.PRLOTN) AS BTCH_NUM,\n    NULL AS BILL_ICMPT_STS_CD,\n    NULL AS CNFRM_STS_CD,\n    NULL AS MFG_DTTM,\n    NULL AS DELV_BILL_STS_CD,\n    NULL AS DELV_CMPLT_IND,\n    NULL AS DELV_ICMPT_STS_CD,\n    NULL AS DELV_STS_CD,\n    NULL AS DELV_TOT_STS_CD,\n    NULL AS EXP_DTTM,\n    NULL AS GM_ICMPT_STS_CD,\n    NULL AS GM_STS_CD,\n    NULL AS INTCO_BILL_STS_CD,\n    TRIM (F43121.PRLITM) AS MATL_NUM,\n    NULL AS ICMPT_STS_CD,\n    NULL AS NUM_OF_CNTNRS_CNT,\n    NULL AS ORDR_BILL_STS_CD,\n    NULL AS PACK_ICMPT_STS_CD,\n    NULL AS PACK_STS_CD,\n    NULL AS PICK_CNFRM_STS_CD,\n    NULL AS PICK_ICMPT_STS_CD,\n    NULL AS PICK_STS_CD,\n    NULL AS PRC_ICMPT_STS_CD,\n    NULL AS PRCSG_TOT_STS_CD,\n    NULL AS RECV_PLNT_CD,\n    NULL AS REF_STS_CD,\n    NULL AS REF_TOT_STS_CD,\n    NULL AS REJ_STS_CD,\n    TRIM (F43121.PRLNID) AS SLS_ORDR_LINE_NBR_REF,\n    NULL AS SLS_ORDR_TYPE_CD,\n    TRIM (F43121.PRUOM) AS SLS_UOM_CD,\n    TRIM (F43121.PRMCU) AS SHIPPING_PLNT_CD,\n    TRIM (F43121.PRLOCN) AS SLOC_CD,\n    NULL AS VEND_BTCH_NUM,\n    NULL AS WM_STS_CD,\n    NULL AS CRT_DTTM,\n    NULL AS ITM_TYPE,\n    NULL AS ITM_OF_REF_DOC,\n    NULL AS GRS_WT_MEAS,\n    NULL AS NET_WT_MEAS,\n    NULL AS WT_UOM_CD,\n    NULL AS VOL_MEAS,\n    NULL AS VOL_UOM_CD,\n    NULL AS NET_VAL_AMT,\n    NULL AS PROD_HIER_CD,\n    NULL AS MATL_GRP_4,\n    NULL AS MATL_GRP_4_DESC,\n    NULL AS DSTR_CHNL_CD,\n    NULL AS ITM_BILL_BLK_STS_CD,\n    NULL AS ITM_OVRL_DELV_BLK_STS_CD,\n    NULL AS ENT_MATL_NUM,\n    NULL AS DIVISION_CD,\n    NULL AS DOC_CAT_SD,\n    NULL AS MATL_GRP_CD,\n    NULL AS MATL_TYPE_CD,\n    NULL AS CUM_BTCH_QTY,\n    F43121.PRSFXO AS ORDR_SFX,\n    F43121.PRMATC AS MATCH_TYPE,\n    TRIM (F43121.PRLNTY) AS LINE_TYPE_DELV,\n NULL AS ORIG_QTY_DELV_ITM\n  from\n    {Config.sourceDatabase}.F43121 F43121\n  where\n    F43121._deleted_ = 'F'\n)\n        select\n           '{Config.sourceSystem}'   AS SRC_SYS_CD,\n          mysub.DELV_NUM AS DELV_NUM,\n          mysub.DELV_LINE_NBR AS DELV_LINE_NBR,\n          mysub.DELV_TYP_CD AS DELV_TYP_CD,\n          mysub.CO_CD AS CO_CD,\n          mysub.MATL_SHRT_DESC AS MATL_SHRT_DESC,\n          mysub.MATL_MVMT_TYPE_CD AS MATL_MVMT_TYPE_CD,\n          mysub.DOC_REF_NUM AS DOC_REF_NUM,\n          mysub.PICK_CNTL_STS_CD AS PICK_CNTL_STS_CD,\n          mysub.LINE_ITEM_CAT_CD AS LINE_ITEM_CAT_CD,\n          mysub.SPL_STK_TYPE_CD AS SPL_STK_TYPE_CD,\n          mysub.PARNT_BTCH_SPLT_CNTR_NBR AS PARNT_BTCH_SPLT_CNTR_NBR,\n          mysub.PARNT_BOM_CNTR_NBR AS PARNT_BOM_CNTR_NBR,\n          mysub.FCTR_NMRTR_MEAS AS FCTR_NMRTR_MEAS,\n          mysub.FCTR_DNMNTR_MEAS AS FCTR_DNMNTR_MEAS,\n          mysub.ACTL_GI_DTTM AS ACTL_GI_DTTM,\n          CAST (mysub.ACTL_SLS_UNIT_DELV_QTY AS DECIMAL(18, 4)) AS ACTL_SLS_UNIT_DELV_QTY,\n          mysub.ACTL_SKU_DELV_QTY AS ACTL_SKU_DELV_QTY,\n          mysub.BASE_UOM_CD AS BASE_UOM_CD,\n          mysub.BTCH_NUM AS BTCH_NUM,\n          mysub.BILL_ICMPT_STS_CD AS BILL_ICMPT_STS_CD,\n          mysub.CNFRM_STS_CD AS CNFRM_STS_CD,\n          mysub.MFG_DTTM AS MFG_DTTM,\n          mysub.DELV_BILL_STS_CD AS DELV_BILL_STS_CD,\n          mysub.DELV_CMPLT_IND AS DELV_CMPLT_IND,\n          mysub.DELV_ICMPT_STS_CD AS DELV_ICMPT_STS_CD,\n          mysub.DELV_STS_CD AS DELV_STS_CD,\n          mysub.DELV_TOT_STS_CD AS DELV_TOT_STS_CD,\n          mysub.EXP_DTTM AS EXP_DTTM,\n          mysub.GM_ICMPT_STS_CD AS GM_ICMPT_STS_CD,\n          mysub.GM_STS_CD AS GM_STS_CD,\n          mysub.INTCO_BILL_STS_CD AS INTCO_BILL_STS_CD,\n          mysub.MATL_NUM AS MATL_NUM,\n          mysub.ICMPT_STS_CD AS ICMPT_STS_CD,\n          mysub.NUM_OF_CNTNRS_CNT AS NUM_OF_CNTNRS_CNT,\n          mysub.ORDR_BILL_STS_CD AS ORDR_BILL_STS_CD,\n          mysub.PACK_ICMPT_STS_CD AS PACK_ICMPT_STS_CD,\n          mysub.PACK_STS_CD AS PACK_STS_CD,\n          mysub.PICK_CNFRM_STS_CD AS PICK_CNFRM_STS_CD,\n          mysub.PICK_ICMPT_STS_CD AS PICK_ICMPT_STS_CD,\n          mysub.PICK_STS_CD AS PICK_STS_CD,\n          mysub.PRC_ICMPT_STS_CD AS PRC_ICMPT_STS_CD,\n          mysub.PRCSG_TOT_STS_CD AS PRCSG_TOT_STS_CD,\n          mysub.RECV_PLNT_CD AS RECV_PLNT_CD,\n          mysub.REF_STS_CD AS REF_STS_CD,\n          mysub.REF_TOT_STS_CD AS REF_TOT_STS_CD,\n          mysub.REJ_STS_CD AS REJ_STS_CD,\n          mysub.SLS_ORDR_LINE_NBR_REF AS SLS_ORDR_LINE_NBR_REF,\n          mysub.SLS_ORDR_TYPE_CD AS SLS_ORDR_TYPE_CD,\n          mysub.SLS_UOM_CD AS SLS_UOM_CD,\n          mysub.SHIPPING_PLNT_CD AS SHIPPING_PLNT_CD,\n          mysub.SLOC_CD AS SLOC_CD,\n          mysub.VEND_BTCH_NUM AS VEND_BTCH_NUM,\n          mysub.WM_STS_CD AS WM_STS_CD,\n          mysub.CRT_DTTM AS CRT_DTTM,\n          mysub.ITM_TYPE AS ITM_TYPE,\n          mysub.ITM_OF_REF_DOC AS ITM_OF_REF_DOC,\n          mysub.GRS_WT_MEAS AS GRS_WT_MEAS,\n          mysub.NET_WT_MEAS AS NET_WT_MEAS,\n          mysub.WT_UOM_CD AS WT_UOM_CD,\n          mysub.VOL_MEAS AS VOL_MEAS,\n          mysub.VOL_UOM_CD AS VOL_UOM_CD,\n          mysub.NET_VAL_AMT AS NET_VAL_AMT,\n          mysub.PROD_HIER_CD AS PROD_HIER_CD,\n          mysub.MATL_GRP_4 AS MATL_GRP_4,\n          mysub.MATL_GRP_4_DESC AS MATL_GRP_4_DESC,\n          mysub.DSTR_CHNL_CD AS DSTR_CHNL_CD,\n          mysub.ITM_BILL_BLK_STS_CD AS ITM_BILL_BLK_STS_CD,\n          mysub.ITM_OVRL_DELV_BLK_STS_CD AS ITM_OVRL_DELV_BLK_STS_CD,\n          mysub.ENT_MATL_NUM AS ENT_MATL_NUM,\n          mysub.DIVISION_CD AS DIVISION_CD,\n          mysub.DOC_CAT_SD AS DOC_CAT_SD,\n          mysub.MATL_GRP_CD AS MATL_GRP_CD,\n          mysub.MATL_TYPE_CD AS MATL_TYPE_CD,\n          mysub.CUM_BTCH_QTY AS CUM_BTCH_QTY,\n          mysub.ORDR_SFX AS ORDR_SFX,\n          COALESCE(mysub.MATCH_TYPE, 'NULL') AS MATCH_TYPE,\n          mysub.LINE_TYPE_DELV AS LINE_TYPE_DELV,\n          mysub.SRC_TBL_NM AS SRC_TBL_NM,\n    mysub.ORIG_QTY_DELV_ITM AS ORIG_QTY_DELV_ITM\n        from\n          mysub mysub  \n \n\"\"\")",
            "scriptMethodHeader" : "def Script(spark: SparkSession) -> DataFrame:",
            "scriptMethodFooter" : "    return out0"
          }
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      }
    }


    