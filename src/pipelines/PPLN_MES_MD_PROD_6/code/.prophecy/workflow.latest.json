{
      "metainfo" : {
        "id" : "1",
        "language" : "python",
        "fabricId" : "32",
        "frontEndLanguage" : "sql",
        "mode" : "batch",
        "udfs" : {
          "language" : "python",
          "udfs" : [ ]
        },
        "udafs" : {
          "language" : "python",
          "code" : ""
        },
        "configuration" : {
          "common" : {
            "type" : "record",
            "fields" : [ {
              "name" : "targetSchema",
              "kind" : {
                "type" : "string",
                "value" : "dev_md_l1"
              },
              "optional" : false
            }, {
              "name" : "sourceSystem",
              "kind" : {
                "type" : "string",
                "value" : "mer"
              },
              "optional" : false
            }, {
              "name" : "sourceDatabase",
              "kind" : {
                "type" : "string",
                "value" : "mer"
              },
              "optional" : false
            } ]
          },
          "oldCommon" : {
            "type" : "record",
            "fields" : [ ]
          },
          "fabrics" : { },
          "instances" : { },
          "selected" : "default",
          "nonEditable" : [ ],
          "isSubscribedPipelineWithPipelineConfigs" : false
        },
        "sparkConf" : [ ],
        "hadoopConf" : [ ],
        "codeMode" : "sparse",
        "buildSystem" : "maven",
        "externalDependencies" : [ ],
        "isImported" : false,
        "interimMode" : "Full",
        "interimModeEnabled" : true,
        "visualCodeInterimMode" : "Disabled",
        "recordsLimit" : {
          "enabled" : false,
          "value" : 1000
        },
        "topLevelPackage" : "PPLN_MES_MD_PROD_6"
      },
      "connections" : [ {
        "id" : "8d7dc68c-36a8-4256-b0a4-ddffc230e9b2",
        "source" : "ddaed95f-3a00-4ea8-9ffd-c2dad4cc8156",
        "sourcePort" : "5535e211-13f5-490c-bfa8-991f98014da2",
        "target" : "fe04d88c-0e19-483f-9d03-640b866fdd89",
        "targetPort" : "f3d59f46-d02f-4dc5-84fb-42d91c95c966"
      }, {
        "id" : "51672eb9-8ae9-41ed-b395-793adf76917e",
        "source" : "0b5f7287-f657-4c75-a0d0-c5938999b21d",
        "sourcePort" : "a6afaa73-38a0-40ac-a394-7a4761d1869d",
        "target" : "ddaed95f-3a00-4ea8-9ffd-c2dad4cc8156",
        "targetPort" : "aced8d36-ab20-4f4d-8a7b-3476d0d0b3de"
      } ],
      "processes" : {
        "fe04d88c-0e19-483f-9d03-640b866fdd89" : {
          "id" : "fe04d88c-0e19-483f-9d03-640b866fdd89",
          "component" : "Target",
          "metadata" : {
            "label" : "MES_MD_PROD",
            "slug" : "MES_MD_PROD",
            "x" : -540,
            "y" : -400,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "f3d59f46-d02f-4dc5-84fb-42d91c95c966",
              "slug" : "in0",
              "isStreaming" : false
            } ],
            "outputs" : [ ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false
          },
          "properties" : {
            "datasetId" : "datasets/MES_MD_PROD"
          }
        },
        "ddaed95f-3a00-4ea8-9ffd-c2dad4cc8156" : {
          "id" : "ddaed95f-3a00-4ea8-9ffd-c2dad4cc8156",
          "component" : "SchemaTransform",
          "metadata" : {
            "label" : "addL1fields",
            "slug" : "addL1fields",
            "x" : -780,
            "y" : -400,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ {
              "id" : "aced8d36-ab20-4f4d-8a7b-3476d0d0b3de",
              "slug" : "in0",
              "isStreaming" : false
            } ],
            "outputs" : [ {
              "id" : "5535e211-13f5-490c-bfa8-991f98014da2",
              "slug" : "out",
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : false
          },
          "properties" : {
            "columnsSelector" : [ ],
            "transformations" : [ {
              "kind" : "AddReplaceColumn",
              "AddReplaceColumn" : {
                "sourceColumn" : "SRC_SYS_CD",
                "expression" : {
                  "format" : "sql",
                  "expression" : "'$sourceSystem'"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              }
            }, {
              "kind" : "AddReplaceColumn",
              "AddReplaceColumn" : {
                "sourceColumn" : "_pk_",
                "expression" : {
                  "format" : "sql",
                  "expression" : "to_json(named_struct('SRC_SYS_CD',SRC_SYS_CD,'PROD_ID',PROD_ID))"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              }
            }, {
              "kind" : "AddReplaceColumn",
              "AddReplaceColumn" : {
                "sourceColumn" : "_pk_md5_",
                "expression" : {
                  "format" : "sql",
                  "expression" : "md5(to_json(named_struct('SRC_SYS_CD',SRC_SYS_CD,'PROD_ID',PROD_ID)))"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              }
            }, {
              "kind" : "AddReplaceColumn",
              "AddReplaceColumn" : {
                "sourceColumn" : "_l1_upt_",
                "expression" : {
                  "format" : "sql",
                  "expression" : "current_timestamp()"
                }
              },
              "DropColumn" : {
                "sourceColumn" : ""
              },
              "RenameColumn" : {
                "sourceColumn" : "",
                "targetColumn" : ""
              }
            } ]
          }
        },
        "0b5f7287-f657-4c75-a0d0-c5938999b21d" : {
          "id" : "0b5f7287-f657-4c75-a0d0-c5938999b21d",
          "component" : "Script",
          "metadata" : {
            "label" : "sql_MES_MD_PROD",
            "slug" : "sql_MES_MD_PROD",
            "x" : -1060,
            "y" : -400,
            "phase" : 0,
            "cache" : false,
            "detailedStats" : false,
            "isImported" : false
          },
          "ports" : {
            "inputs" : [ ],
            "outputs" : [ {
              "id" : "a6afaa73-38a0-40ac-a394-7a4761d1869d",
              "slug" : "out0",
              "schema" : {
                "type" : "struct",
                "fields" : [ {
                  "name" : "_deleted_",
                  "type" : "string",
                  "nullable" : true,
                  "metadata" : {
                    "description" : "",
                    "mappings" : [ ],
                    "tags" : [ ]
                  } 
                } ]
              },
              "isStreaming" : false
            } ],
            "selectedInputFields" : [ ],
            "isCustomOutputSchema" : true
          },
          "properties" : {
            "script" : "out0 = spark.sql(f\"\"\"\n    SELECT '{Config.sourceSystem}' AS SRC_SYS_CD\n, TRIM(PRODUCT.PRODUCTID) as PROD_ID\n, CAST(NULL AS STRING) as FCTRY_ID\n, TRIM(PRODUCT.PRODUCTFAMILYID) as PROD_FMLY_ID\n, TRIM(PRODUCT.PRODUCTTYPEID) as PROD_TYPE_ID\n, CAST(NULL AS STRING) as SPEC_ID\n, TRIM(PRODUCT.WORKFLOWBASEID) as WRKF_BASE_ID\n, TRIM(PRODUCT.WORKFLOWID) as WRKF_ID\n, CAST(NULL AS STRING) as ADD_POWER_CD\n, CAST(PRODUCT.ccfAllJobsComplete as BOOLEAN ) as ALL_JOBS_CMPLT_IND\n, CAST(NULL AS TIMESTAMP) as ALWAYS_OVR_RIDE_EXPN_DTTM\n, CAST(NULL AS STRING) as ARMOUR_TYPE_CD\n, CAST(NULL AS INT) as ARMS_CNT\n, CAST(NULL AS STRING) as AXIS_VAL\n, CAST(NULL AS STRING) as BASE_CRV_CD\n, TRIM(PRODUCT.BRANDNAME) as BRND_NM\n, TRIM(PRODUCT.ccfBatchManagementReq) as BTCH_MGMT_REQ_TXT\n, TRIM(PRODUCT.BILLOFPROCESSID) as BILL_OF_PRCS_ID\n, TRIM(PRODUCT.BILLOFPROCESSBASEID) as BILL_OF_PRCS_BASE_ID\n, TRIM(PRODUCT.BOMBASEID) as BOM_BASE_ID\n, TRIM(PRODUCT.BOMID) as BOM_ID\n, CAST(NULL AS BOOLEAN) as BP_BTCH_CTL_IND\n, CAST(NULL AS STRING) as BP_MAX_QTY_ALLW_EXPRSSN_TXT\n, CAST(NULL AS STRING) as BP_MIN_QTY_ALLW_EXPRSSN_TXT\n, CAST(NULL AS STRING) as BP_REQ_QTY_EXPRSSN_TXT\n, CAST(NULL AS STRING) as BP_SCALE_GRP_ID\n, CAST(NULL AS STRING) as BRNCH_PLNT_CD\n, CAST(PRODUCT.cscBypassBatchContainerRelChec as BOOLEAN ) as BYPAS_BTCH_CNTNR_REL_CHK_IND\n, CAST(NULL AS DECIMAL(18,4)) as CTN_QTY\n, CAST(NULL AS STRING) as CTN_TYPE_ID\n, CAST(NULL AS STRING) as CTN_UOM_ID\n, CAST(NULL AS DECIMAL(18,4)) as CASE_QTY\n, CAST(NULL AS STRING) as CASE_UOM_ID\n, TRIM(PRODUCT.CATALOGNUMBER) as CATLG_NUM\n, CAST(NULL AS STRING) as CELL_ID\n, CAST(NULL AS STRING) as CELL_NUM\n, CAST(NULL AS STRING) as CTR_THKNESS_VAL\n, INT(PRODUCT.CHANGECOUNT) as CHG_CNT\n, TRIM(PRODUCT.CHANGEHISTORYID) as CHG_HIST_ID\n, CAST(NULL AS STRING) as COLOR_CD\n, TRIM(PRODUCT.ccfCompletionStatusCodeId) as CMPLT_STS_CD\n, TRIM(PRODUCT.ccfCompletionStatusReasonId) as CMPLT_STS_RSN_CD\n, TRIM(PRODUCT.CONCOMITANTPRODUCTNUMBER) as CNCMTNT_PROD_NUM\n, TRIM(PRODUCT.ccfContainerLevelId) as CNTNR_LVL_ID\n, TRIM(PRODUCT.CONTAINERNUMBERINGRULEID) as CNTNR_NUMING_RULE_ID\n, CAST(NULL AS DECIMAL(18,4)) as CUM_YLD_QTY\n, CAST(PRODUCT.CURRENTCOST AS DECIMAL(18,4)) as CUR_COST_AMT\n, TRIM(PRODUCT.CUSTOMERID) as CUST_ID\n, TRIM(PRODUCT.CUSTOMERPRODUCTNUMBER) as CUST_PROD_NUM\n, CAST(NULL AS STRING) as CYL_VAL\n, CAST(NULL AS STRING) as DFLT_INV_LOC_CD\n, CAST(NULL AS STRING) as DIAM_VAL\n, TRIM(PRODUCT.ccfDeviceTypeId) as DVC_TYPE_ID\n, CAST(NULL AS DECIMAL(18,4)) as DENIER_SIZE_MEAS\n, TRIM(PRODUCT.DEVICETYPE) as DVC_TYPE_CD\n, TRIM(PRODUCT.DOCUMENTSETID) as DOC_SET_ID\n, CAST(NULL AS STRING) as DRWG_NUM\n, TRIM(PRODUCT.ECO) as ENGR_CHG_ORDR_NUM\n, TRIM(PRODUCT.GLENTITY) as ERP_ACTG_ID\n, TRIM(PRODUCT.ERPBOMBASEID) as ERP_BOM_BASE_ID\n, TRIM(PRODUCT.ERPBOMID) as ERP_BOM_ID\n, TRIM(PRODUCT.ccfERPDocument) as ERP_DOC_NM\n, TRIM(PRODUCT.ccfERPDocumentVersion) as ERP_DOC_VERS_NUM\n, TRIM(PRODUCT.ccfERPMaterialNumber) as ERP_MATL_NUM\n, TRIM(PRODUCT.ccfERPPlantId) as ERP_PLNT_ID\n, TRIM(PRODUCT.ccfERPQualInspType) as ERP_QUAL_INSP_TYPE_CD\n, TRIM(PRODUCT.ERPROUTEBASEID) as ERP_RTE_BASE_ID\n, TRIM(PRODUCT.ERPROUTEID) as ERP_RTE_ID\n, CAST(NULL AS STRING) as EXPN_DT_FMT_CD\n, CAST(NULL AS STRING) as EXPN_DT_SPEC_BASE_ID\n, CAST(NULL AS STRING) as EXPN_DT_SPEC_ID\n, CAST(NULL AS STRING) as EXPN_DT_TRX_ID\n, CAST(NULL AS INT) as EXPRIATION_PER_NBR\n, CAST(NULL AS STRING) as EXPRIATION_PER_UNIT_CD\n, CAST(PRODUCT.EXTERNALLYCONTROLLED as BOOLEAN ) as EXTR_CTL_IND\n, CAST(NULL AS STRING) as FMLY_CD\n, TRIM(PRODUCT.FEFOENFORCE) as FEFO_ENFRC_ID\n, TRIM(PRODUCT.FEFOOVERRIDEESIGREQUIREMENTID) as FEFO_OVRDE_SGNTR_REQ_ID\n, CAST(NULL AS BOOLEAN) as GEL_PROD_IND\n, CAST(NULL AS STRING) as GS1_CD\n, TRIM(PRODUCT.ICONID) as ICON_ID\n, CAST(PRODUCT.INSPECTALL as BOOLEAN ) as INSP_ALL_IND\n, CAST(PRODUCT.INVENTORYCONTROLLED as BOOLEAN ) as INV_CTL_IND\n, CAST(NULL AS STRING) as IO_CD\n, CAST(PRODUCT.ISFROZEN as BOOLEAN ) as IS_FRZN_IND\n, CAST(NULL AS BOOLEAN) as IS_LIMERICK_PROD_IND\n, CAST(PRODUCT.ISPHANTOM as BOOLEAN ) as IS_PHANTOM_IND\n, CAST(PRODUCT.ccfIssueFromEnforce as BOOLEAN ) as ISS_FROM_ENFRC_IND\n, CAST(PRODUCT.ccfIssueToEnforce as BOOLEAN ) as ISS_TO_ENFRC_IND\n, CAST(NULL AS STRING) as ITM_NUM\n, CAST(NULL AS STRING) as ITM_SHRT_NM\n, CAST(NULL AS STRING) as JDE_RTE_ID\n, TRIM(PRODUCT.ccfLanguageKey) as LANG_KEY_VAL\n, CAST(NULL AS DECIMAL(18,4)) as LGTH_C_MEAS\n, CAST(NULL AS DECIMAL(18,4)) as LGTH_I_MEAS\n, CAST(NULL AS STRING) as LINE_ID\n, CAST(NULL AS STRING) as LINE_NUM\n, CAST(PRODUCT.LOTCONTROLLED as BOOLEAN ) as LOT_CTL_IND\n, CAST(NULL AS STRING) as MFG_DT_SPEC_BASE_ID\n, CAST(NULL AS STRING) as MFG_DT_SPEC_ID\n, CAST(NULL AS STRING) as MFG_DT_TRX_ID\n, CAST(NULL AS STRING) as MSTR_PLNG_FMLY_CD\n, CAST(NULL AS STRING) as MAX_ADD_POWER_VAL\n, INT(PRODUCT.ccfMaxBatchConsum) as MAX_BTCH_CNSMPTN_CNT\n, CAST(TRIM(PRODUCT.MESf_UpdateExpireOnCompIss) AS BOOLEAN) as MESF_UPDT_EXP_ON_CMPNT_ISS_IND\n, CAST(NULL AS DECIMAL(18,4)) as MFG_LEAD_TIME_MEAS\n, CAST(NULL AS STRING) as MOD_CD\n, TRIM(PRODUCT.MODELNUMBER) as MDL_NUM\n, TRIM(PRODUCT.ccfMRPController) as MRP_CTL_VAL\n, CAST(PRODUCT.ccfMultiLevelProduct as BOOLEAN ) as MULTI_LVL_PROD_IND\n, CAST(NULL AS STRING) as NEEDLE_TYPE_CD\n, TRIM(PRODUCT.NOTES) as NOTES_TXT\n, TRIM(PRODUCT.CDOTYPEID) as OBJ_TYPE_ID\n, CAST(NULL AS STRING) as OPEN_TIME_2_VAL\n, CAST(NULL AS STRING) as OVRD_AQL_LEVL_ID\n, TRIM(PRODUCT.ccfOwnerId) as OWN_ID\n, TRIM(PRODUCT.ccfPeriodIndicator) as PER_CD\n, CAST(NULL AS INT) as PCS_PER_BOX_CNT\n, CAST(PRODUCT.PLANNEDCOST AS DECIMAL(18,4)) as PLAN_COST_AMT\n, CAST(NULL AS STRING) as PLNT_NM\n, CAST(NULL AS STRING) as PRPRC_TXT\n, CAST(NULL AS STRING) as PRCS_SPEC_1_DESC\n, CAST(NULL AS STRING) as PRCS_SPEC_2_DESC\n, CAST(NULL AS STRING) as PRCS_SPEC_CD\n, TRIM(PRODUCT.PRODUCTBASEID) as PROD_BASE_ID\n, CAST(NULL AS STRING) as PROD_BRND_NM\n, CAST(NULL AS STRING) as PROD_DTLS_ID\n, TRIM(PRODUCT.DESCRIPTION) as PROD_DESC\n, CAST(NULL AS STRING) as PROD_2_DESC\n, CAST(NULL AS STRING) as PROD_GRP_ID\n, CAST(NULL AS STRING) as PROD_ISS_GRP_ID\n, CAST(NULL AS STRING) as PROD_OTH_NM\n, TRIM(PRODUCT.ccfProductRecipeBaseId) as PROD_RECIPE_BASE_ID\n, TRIM(PRODUCT.ccfProductRecipeId) as PROD_RECIPE_ID\n, TRIM(PRODUCT.PRODUCTREVISION) as PROD_RVSN_NUM\n, TRIM(PRODUCT.PRODUCTVARIATION) as PROD_VAR_ID\n, CAST(NULL AS STRING) as PROD_VERS_NUM\n, CAST(NULL AS STRING) as PRDTN_ID\n, CAST(NULL AS STRING) as RAW_MATL_TYPE_CD\n, CAST(NULL AS STRING) as RECIPE_NUM\n, CAST(NULL AS STRING) as RESRTABLE_CD\n, CAST(NULL AS BOOLEAN) as RMT_VERIF_REQ_IND\n, CAST(NULL AS STRING) as RXDX_CD\n, TRIM(PRODUCT.SAMPLINGPLANID) as SMPLG_PLAN_ID\n, TRIM(PRODUCT.SAMPLINGPLANBASEID) as SMPLG_PLAN_BASE_ID\n, CAST(NULL AS STRING) as SAP_MATL_NUM\n, CAST(PRODUCT.ccfSendExpDateToERP as BOOLEAN ) as SEND_EXP_DT_TO_ERP_IND\n, CAST(PRODUCT.SERIALCONTROLLED as BOOLEAN ) as SER_CTL_IND\n, CAST(NULL AS INT) as SHLF_LIF_DAYS_CNT\n, CAST(NULL AS STRING) as SHLF_LIF_VAL\n, CAST(NULL AS STRING) as SHRT_BRND_NM\n, CAST(NULL AS STRING) as SHRT_NM\n, CAST(NULL AS STRING) as SKU_COLOR_CD\n, CAST(NULL AS STRING) as SPC_CHRT_GRP_ID\n, CAST(NULL AS STRING) as SPHERE_POWER_VAL\n, CAST(PRODUCT.STDSTARTQTY AS DECIMAL(18,4)) as STD_STRT_QTY\n, CAST(PRODUCT.STDSTARTQTY2 AS DECIMAL(18,4)) as STD_STRT_2_QTY\n, INT(PRODUCT.STDSTARTUOM2ID) as STD_STRT_UOM_2_ID\n, CAST(PRODUCT.STDCOST AS DECIMAL(18,4)) as STD_UNIT_COST_AMT\n, TRIM(PRODUCT.STATUS) as STS_CD\n, TRIM(PRODUCT.STDSTARTUOMID) as STD_STRT_UOM_ID\n, CAST(NULL AS STRING) as STERILIZATION_TYPE_CD\n, CAST(NULL AS STRING) as STER_SPEC_CD\n, CAST(NULL AS STRING) as STER_SPEC_DESC\n, CAST(PRODUCT.STOCKPOINTCONTROLLED as BOOLEAN ) as STK_PT_CTL_IND\n, CAST(NULL AS INT) as ETH_STRAND_CNT\n, TRIM(PRODUCT.SUBFACTORY) as SUB_FCTRY_NM\n, CAST(NULL AS DECIMAL(18,4)) as SUTURE_LEN_MEAS\n, CAST(NULL AS STRING) as SUTURE_MTRC_CD\n, CAST(NULL AS DECIMAL(18,4)) as SUTURE_SIZE_MEAS\n, CAST(PRODUCT.TARGETCYCLETIME AS DECIMAL(18,4)) as TRGT_CYC_TM\n, TRIM(PRODUCT.TARGETDURATIONPERUNIT) as TRGT_DUR_PER_UNIT_VAL\n, CAST(PRODUCT.TARGETFINALYIELD AS DECIMAL(18,4)) as TRGT_FNL_YLD_AMT\n, CAST(PRODUCT.TARGETROLLEDTHROUGHPUTYIELD AS DECIMAL(18,4)) as TRGT_ROLLD_THRUPUT_YLD_QTY\n, CAST(PRODUCT.TARGETUNITSPERHOUR AS DECIMAL(18,4)) as TRGT_UNIT_PER_HR_QTY\n, CAST(NULL AS STRING) as TEAM_CTR_RLSE_STS_CD\n, TRIM(PRODUCT.ccfTotalShelfLife) as TOT_SHLF_LIF_VAL\n, CAST(NULL AS STRING) as TRACEABL_INFO_TXT\n, INT(PRODUCT.ccfTrngRecentExpDays) as TRNG_RCNT_EXP_DAYS_CNT\n, TRIM(PRODUCT.ccfTrngRecentId) as TRNG_RCNT_ID\n, TRIM(PRODUCT.TRAININGREQGROUPID) as TRNG_REQ_GRP_ID\n, CAST(NULL AS STRING) as UDI_ID\n, CAST(NULL AS STRING) as UDI_TRX_ID\n, CAST(NULL AS STRING) as UOM_2_ID\n, TRIM(PRODUCT.ccfUOMConversionDenominator) as UOM_CONV_DENOM_VAL\n, TRIM(PRODUCT.ccfUOMConversionNumerator) as UOM_CONV_NUMRTR_VAL\n, CAST(NULL AS STRING) as UPC_CHK_DIG_NUM\n, CAST(NULL AS STRING) as UPC_NUM\n, CAST(NULL AS STRING) as UV_CD\n, TRIM(PRODUCT.ccfValueStream) as VAL_STREM_TXT\n, CAST(NULL AS STRING) as VRNT_TYPE_CD\n, CAST(NULL AS STRING) as VISIT_INT_CD\n, TRIM(PRODUCT.WIPMSGDEFMGRID) as WIP_MSG_DEF_MGR_ID\n, TRIM(PRODUCT.ccfStartReasonId) as STRT_RSN_ID\n, CAST(NULL AS INT) as STRAND_CNT\nFROM  {Config.sourceDatabase}.PRODUCT as PRODUCT WHERE PRODUCT._deleted_ =  'F'\n  \n \n\"\"\")",
            "scriptMethodHeader" : "def Script(spark: SparkSession) -> DataFrame:",
            "scriptMethodFooter" : "    return out0"
          }
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      }
    }


    